
window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#form"),t=e.querySelector("#nights"),n=e.querySelector("#nights-to"),r=e.querySelector("#depart-city"),o=e.querySelector("#country"),i=document.querySelector("#tourTableBody"),a=document.querySelector(".tour-table thead"),u=document.querySelector(".tours__title"),c=g(90),d=g(1);function l(e,t){e.value="",e.setAttribute("placeholder",t),e.classList.add("error")}function s(e){e.classList.remove("error"),e.setAttribute("placeholder","от 5 до 15")}function h(e){return e>=0&&e<10?"0"+e:e}function p(e,t){return e.price>t.price?1:e.price<t.price?-1:0}function g(e){return function(e){const t=Date.now()+e,n=new Date(t).getDate(),r=new Date(t).getMonth()+1,o=new Date(t).getFullYear();return`${o}-${h(r)}-${h(n)}`}(function(e){return 864e5*e}(e))}var v,y;t.addEventListener("input",e=>{const t=e.target;n.value.length>0&&+n.value<=+t.value?l(t,"Больше чем до"):n.value>t.value&&s(t)}),n.addEventListener("change",e=>{const n=e.target;t.value.length>0&&+t.value>=+n.value?l(n,"Меньше чем от"):n.value>t.value&&s(n)}),v="date-input",y=c,document.getElementById(v).setAttribute("max",y),function(e,t){document.getElementById(e).setAttribute("min",t)}("date-input",d),e.addEventListener("submit",e=>{e.preventDefault();const c=Object.fromEntries(new FormData(e.target).entries()),{departCity:d,country:l,date:h,nights:g,nightsTo:v}=c;(async({departCity:e,country:t,date:n,nights:r,nightsTo:o}={})=>{const i=await fetch(`https://ht.kz/test/searchPartner1?departCity=${e}&country=${t}&date=${n}&nights=${r}&nightsTo=${o}`);return await i.json()})({departCity:d,country:l,date:h,nights:g,nightsTo:v}).then(e=>{const t=e.tours.sort(p);let n=r[r.options.selectedIndex].innerText,c=o[o.options.selectedIndex].innerText,d=new Date(h).toLocaleDateString("lookup",{year:"numeric",month:"long",day:"numeric"}).replace(/г.$/g,"").trim();u.innerHTML=`\n      <h2>\n        Результаты запроса (${n} -\n        ${c},\n        ${d},\n        ${g}-${v}н.):\n      </h2>\n      `,a.innerHTML="\n        <tr>\n          <th>Hotel name</th>\n          <th>price</th>\n          <th>currency</th>\n        </tr>\n      ",t.forEach(e=>{i.innerHTML+=`\n        <tr>\n          <td>${e.hotelName}</td>\n          <td>${e.price}</td>\n          <td>${e.currency}</td>\n        </tr>\n        `,document.querySelector("#tours").classList.add("tours")})}).catch(e=>{throw new Error(`${e.name} ${e.message}`)}).finally(()=>{e.target.reset(),s(t),s(n)})}),r.addEventListener("change",e=>{const t=e.target;t&&"10"===r.value?o.innerHTML='\n      <option value="" disabled selected hidden>Страна</option>\n      <option value="552">Турция</option>\n      <option value="553">Тайланд</option>':t&&"11"===r.value?o.innerHTML='\n      <option value="" disabled selected hidden>Страна</option>\n      <option value="552">Турция</option>\n      <option value="554">Чехия</option>':o.innerHTML='\n      <option value="" disabled selected hidden>Страна</option>\n      <option>Страна</option>\n      '})});
//# sourceMappingURL=../sourcemaps/main.min.js.map
